"use strict";

var _utils = require("../utils");
var _utils2 = require("./utils");
var focusable = function focusable(props) {
  if (!props) {
    props = {};
  }
  var nodeObject = {
    id: 'child',
    tabindex: 0
  };
  Object.keys(props).forEach(function (key) {
    nodeObject[key] = props[key];
  });
  return (0, _utils2.node)(nodeObject);
};
var scenarios = {
  tabIndexMinusOne: (0, _utils2.node)({
    id: 'child',
    tabindex: -1
  }),
  focusable: focusable(),
  button: focusable({
    tag: 'button'
  }),
  buttonWithDisabled: focusable({
    tag: 'button',
    valueOnlyAttribute: 'disabled'
  }),
  link: focusable({
    tag: 'a',
    href: 'www.enactjs.com'
  }),
  input: focusable({
    tag: 'input'
  })
};
describe('utils', function () {
  describe('#getPointRect', function () {
    test('should return an rect value calculated based on given position', function () {
      var expected = {
        left: 10,
        top: 20,
        width: 0,
        height: 0,
        right: 10,
        bottom: 20,
        center: {
          x: 10,
          y: 20,
          left: 10,
          right: 10,
          top: 20,
          bottom: 20
        }
      };
      var actual = (0, _utils.getPointRect)({
        x: 10,
        y: 20
      });
      expect(actual).toEqual(expected);
    });
  });
  describe('#getContainerRect', function () {
    test('should return an viewPort rect value when container is document', function () {
      var innerWidth = window.innerWidth;
      var innerHeight = window.innerHeight;
      var actual = (0, _utils.getContainerRect)('spotlightRootDecorator');
      var expected = {
        left: 0,
        top: 0,
        width: innerWidth,
        height: innerHeight,
        right: innerWidth,
        bottom: innerHeight,
        center: {
          x: innerWidth / 2,
          y: innerHeight / 2,
          left: innerWidth / 2,
          right: innerWidth / 2,
          top: innerHeight / 2,
          bottom: innerHeight / 2
        }
      };
      expect(actual).toEqual(expected);
    });
  });
  describe('#isStandardFocusable', function () {
    beforeEach(function () {
      global.Element.prototype.getBoundingClientRect = jest.fn(function () {
        return {
          height: 100,
          width: 100
        };
      });
    });
    test('should return false if tabIndex < 0', (0, _utils2.testScenario)(scenarios.tabIndexMinusOne, function (root) {
      var child = root.querySelector('#child');
      var expected = false;
      var actual = (0, _utils.isStandardFocusable)(child);
      expect(actual).toEqual(expected);
    }));
    test('should return false if hidden', (0, _utils2.testScenario)(scenarios.focusable, function (root) {
      var child = root.querySelector('#child');
      child.getBoundingClientRect = jest.fn(function () {
        return {
          height: 0,
          width: 0
        };
      });
      var expected = false;
      var actual = (0, _utils.isStandardFocusable)(child);
      expect(actual).toEqual(expected);
    }));
    test('should return true if button tag', (0, _utils2.testScenario)(scenarios.button, function (root) {
      var child = root.querySelector('#child');
      var expected = true;
      var actual = (0, _utils.isStandardFocusable)(child);
      expect(actual).toEqual(expected);
    }));
    test('should return false if button tag with disabled', (0, _utils2.testScenario)(scenarios.buttonWithDisabled, function (root) {
      var child = root.querySelector('#child');
      var expected = false;
      var actual = (0, _utils.isStandardFocusable)(child);
      expect(actual).toEqual(expected);
    }));
    test('should return true if A tag with href', (0, _utils2.testScenario)(scenarios.link, function (root) {
      var child = root.querySelector('#child');
      var expected = true;
      var actual = (0, _utils.isStandardFocusable)(child);
      expect(actual).toEqual(expected);
    }));
    test('should return true if input tag', (0, _utils2.testScenario)(scenarios.input, function (root) {
      var child = root.querySelector('#child');
      var expected = true;
      var actual = (0, _utils.isStandardFocusable)(child);
      expect(actual).toEqual(expected);
    }));
  });
});